{% extends 'blog/base.html' %}

{% block content %}
<article class="media content-section p-3 mb-4 rounded" style="background-color: #f8f9fa;">
    <!-- Author Image -->
    <img class="rounded-circle account-img mr-3" src="{{ object.author.profile_image_url  }}" alt="Author image" style="width: 80px; height: 80px;">
    
    <div class="media-body">
        <!-- Metadata -->
        <div class="article-metadata mb-2">
            <a class="mr-2 font-weight-bold" href="{% url 'user-posts' object.author.username %}">{{ object.author }}</a>
            <small class="text-muted">{{ object.date_posted|date:"F d, Y" }}</small>

            <!-- Edit/Delete Buttons for Author -->
            {% if object.author == user %}
            <div class="mt-2">
                <a class="btn btn-sm btn-outline-secondary mr-2" href="{% url 'post-update' pk=object.pk %}">Edit</a>
                <a class="btn btn-sm btn-outline-danger" href="{% url 'post-delete' pk=object.pk %}">Delete</a>
            </div>
            {% endif %}
        </div>

        <!-- Post Content -->
        <h2 class="article-title"><a href="#" style="color: #333; text-decoration: none;">{{ object.title }}</a></h2>
        <p class="article-content" style="font-size: 1.1rem; color: #555; line-height: 1.6;">{{ object.content }}</p>
    </div>
</article>

<!-- Comments Section -->
<section class="content-section mt-3">
    <h3 class="mt-3" style="font-size: 1.5rem; color: #4e73df;">Comments:</h3>
    <ul class="list-unstyled">
        {% for comment in object.comments.all %}
        <li class="media mb-3 p-3 bg-light rounded">
            <div class="media-body">
                <h5 class="mt-0 mb-1">{{ comment.author }}</h5>
                <p>{{ comment.body }}</p>
                <!-- Delete button visible only to the post author -->
                {% if object.author == user %}
                <a href="{% url 'comment-delete' comment.pk %}" class="btn btn-outline-danger btn-sm">Delete</a>
                {% endif %}
            </div>
        </li>
        {% endfor %}
    </ul>

    <!-- Add a Comment Section -->
    <div class="mt-3">
        <h4 style="font-size: 1.25rem; color: #4e73df;">Add a Comment:</h4>
        <a href="{% url 'add_comment' object.pk %}" class="btn btn-primary btn-sm">Add your comment here</a>
    </div>
</section>
{% endblock content %}
