{% extends 'blog/base.html' %}

{% block content %}
<article class="media content-section p-3 mb-4 rounded" style="background-color: #f8f9fa; padding: 20px; border-radius: 10px;">
    <!-- Author Image -->
    <img class="rounded-circle account-img mr-3" src="{{ object.author.profile.image.url }}" alt="Author image" style="width: 80px; height: 80px; object-fit: cover; border: 2px solid #ddd;">

    <div class="media-body" style="flex: 1;">
        <!-- Metadata -->
        <div class="article-metadata mb-2" style="margin-bottom: 10px;">
            <a class="mr-2 font-weight-bold" href="{% url 'user-posts' object.author.username %}" style="color: #007bff; text-decoration: none; font-size: 1.1rem;">{{ object.author }}</a>
            <small class="text-muted" style="font-size: 0.9rem;">{{ object.date_posted|date:"F d, Y" }}</small>

            <!-- Edit/Delete Buttons for Author -->
            {% if object.author == user %}
            <div class="mt-2" style="margin-top: 10px;">
                <a class="btn btn-sm btn-outline-secondary mr-2" href="{% url 'post-update' pk=object.pk %}" style="border-radius: 5px; padding: 5px 10px; font-size: 0.9rem;">Edit</a>
                <a class="btn btn-sm btn-outline-danger" href="{% url 'post-delete' pk=object.pk %}" style="border-radius: 5px; padding: 5px 10px; font-size: 0.9rem;">Delete</a>
            </div>
            {% endif %}
        </div>

        <!-- Post Content -->
        <img src="{% if object.post_image %}{{ object.post_image.url }}{% else %}default_image_url{% endif %}" alt="{{ object.title }}" style="width: 100%; height: auto; border-radius: 10px; margin-bottom: 15px; object-fit: cover;">

        <h2 class="article-title" style="font-size: 1.75rem; color: #333; margin-bottom: 10px;">
            <a href="#" style="color: inherit; text-decoration: none;">{{ object.title }}</a>
        </h2>
        <p class="article-content" style="font-size: 1.1rem; color: #555; line-height: 1.6; margin-bottom: 20px;">{{ object.content }}</p>
    </div>
</article>

<!-- Comments Section -->
<section class="content-section mt-3" style="margin-top: 20px;">
    <h3 class="mt-3" style="font-size: 1.5rem; color: #4e73df; margin-bottom: 15px;">Comments:</h3>
    <ul class="list-unstyled">
        {% for comment in object.comments.all %}
        <li class="media mb-3 p-3 bg-light rounded" style="padding: 15px; border-radius: 8px;">
            <div class="media-body">
                <h5 class="mt-0 mb-1" style="font-size: 1.2rem; color: #333;">{{ comment.author }}</h5>
                <p style="font-size: 1rem; color: #666;">{{ comment.body }}</p>
                <!-- Delete button visible only to the post author -->
                {% if object.author == user %}
                <a href="{% url 'comment-delete' comment.pk %}" class="btn btn-outline-danger btn-sm" style="border-radius: 5px; padding: 3px 7px; font-size: 0.9rem;">Delete</a>
                {% endif %}
            </div>
        </li>
        {% endfor %}
    </ul>

    <!-- Add a Comment Section -->
    <div class="mt-3" style="margin-top: 20px;">
        <h4 style="font-size: 1.25rem; color: #4e73df; margin-bottom: 10px;">Add a Comment:</h4>
        <a href="{% url 'add_comment' object.pk %}" class="btn btn-primary btn-sm" style="border-radius: 5px; padding: 5px 10px; font-size: 0.9rem;">Add your comment here</a>
    </div>
</section>
{% endblock content %}
